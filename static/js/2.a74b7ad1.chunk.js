(this.webpackJsonpcboard=this.webpackJsonpcboard||[]).push([[2],{1891:function(e,t,r){"use strict";r.r(t),r.d(t,"IMPORT_CONFIG_BY_EXTENSION",(function(){return o})),r.d(t,"IMPORT_PATHS",(function(){return i})),r.d(t,"CBOARD_EXT_PREFIX",(function(){return u})),r.d(t,"CBOARD_EXT_PROPERTIES",(function(){return c}));var n=r(1892),a=r(477),o={json:n.cboardImportAdapter,zip:n.obzImportAdapter,obz:n.obzImportAdapter,obf:n.obfImportAdapter},i={boards:".obf",images:"images/"},u=a.b,c=a.c;t.default={IMPORT_CONFIG_BY_EXTENSION:o,IMPORT_PATHS:i,CBOARD_EXT_PREFIX:u,CBOARD_EXT_PROPERTIES:c}},1892:function(e,t,r){"use strict";r.r(t),r.d(t,"cboardImportAdapter",(function(){return k})),r.d(t,"obzImportAdapter",(function(){return P})),r.d(t,"obfImportAdapter",(function(){return R})),r.d(t,"requestQuota",(function(){return A}));var n=r(2),a=r.n(n),o=r(12),i=r(1893),u=r.n(i),c=r(1883),s=r.n(c),f=r(73),p=r.n(f),d=r(1891),l=r(23);function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=/(_\w)/g,r=function(e){return e[1].toUpperCase()};return e.replace(t,r)}function h(e){return v.apply(this,arguments)}function v(){return(v=Object(o.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var r=new FileReader;r.onload=function(t){if(2===t.target.readyState)try{e(new Blob([r.result]))}catch(n){e(null)}},r.readAsArrayBuffer(t)}));case 2:if(null!==(r=e.sent)){e.next=5;break}return e.abrupt("return",Promise.reject());case 5:return n=URL.createObjectURL(r),e.abrupt("return",new Promise((function(e){u.a.getBinaryContent(n,(function(t,r){e(t||s.a.loadAsync(r))}))})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){var t={id:e.id||p.a.generate(),label:e.label||""};return e.background_color&&(t.backgroundColor=e.background_color),e.border_color&&(t.borderColor=e.border_color),e.vocalization&&(t.vocalization=e.vocalization),e.action&&(t.action=e.action),t}function w(e){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(a.a.mark((function e(t){var r,n,i,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:{},n=u.length>2&&void 0!==u[2]?u[2]:{},e.next=4,Promise.all(t.buttons.map(function(){var e=Object(o.a)(a.a.mark((function e(o){var i,u,c,s,f,p,h,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=y(o),o.load_board&&(u=o.load_board).path&&r[u.path]&&(i.loadBoard=r[u.path].id),!o.image_id){e.next=24;break}if(c=o.image_id,!(s=t.images.find((function(e){return e.id===c})))){e.next=24;break}if(f=s.data||null,s.content_type&&s.path&&n[s.path]&&(p="image/svg"===s.content_type?"image/svg+xml":s.content_type,f="data:".concat(p,";base64,").concat(n[s.path])),s.url&&(i.image=s.url),!f){e.next=24;break}return h=f,e.prev=11,e.next=14,l.a.uploadFromDataURL(h,c,!0);case 14:v=e.sent,h=v||h,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),console.log(e.t0.message);case 21:return e.prev=21,i.image=h,e.finish(21);case 24:return Object.keys(o).filter((function(e){return e.startsWith(d.CBOARD_EXT_PREFIX)})).forEach((function(e){var t=b(e.slice(d.CBOARD_EXT_PREFIX.length));i[t]=o[e]})),e.abrupt("return",i);case 27:case"end":return e.stop()}}),e,null,[[11,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()));case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=Object(o.a)(a.a.mark((function e(t){var r,n,o,i,u,c=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:{},n=c.length>2&&void 0!==c[2]?c[2]:{},o=c.length>3&&void 0!==c[3]?c[3]:[],!_(o).includes(t.id)){e.next=6;break}return e.abrupt("return",void 0);case 6:if(i=[],!t.buttons){e.next=11;break}return e.next=10,w(t,r,n);case 10:i=e.sent;case 11:return u={id:t.id||p.a.generate(),tiles:i},Object.keys(t).filter((function(e){return e.startsWith(d.CBOARD_EXT_PREFIX)})).forEach((function(e){var r=b(e.slice(d.CBOARD_EXT_PREFIX.length));u[r]=t[e]})),"undefined"!==typeof t.name?u.name=t.name:u.name="unknown name",t.locale&&(u.locale=t.locale),e.abrupt("return",u);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){var t=[];return e.forEach((function(e){"undefined"!==typeof e.id&&t.push(e.id),"undefined"!==typeof e.prevId&&t.push(e.prevId)})),t}function k(e,t,r){return O.apply(this,arguments)}function O(){return(O=Object(o.a)(a.a.mark((function e(t,r,n){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new FileReader,e.abrupt("return",new Promise((function(e,r){i.onload=function(){var t=Object(o.a)(a.a.mark((function t(o){var u,c,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(2===o.target.readyState)try{u=JSON.parse(i.result),c=_(n),s=u.filter((function(e){return("undefined"===typeof e.ext_cboard_hidden||!e.ext_cboard_hidden)&&"root"!==e.id&&!c.includes(e.id)})),e(s)}catch(a){r(a)}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),i.readAsText(t)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t,r){return E.apply(this,arguments)}function E(){return(E=Object(o.a)(a.a.mark((function e(t,r,n){var i,u,c,s,f,p,l,b,v,y;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:if("object"===typeof(i=e.sent)){e.next=5;break}throw new Error(i);case 5:return u=Object.keys(i.files),c=u.filter((function(e){return!i.files[e].dir&&e.endsWith(d.IMPORT_PATHS.boards)})),s=u.filter((function(e){return!i.files[e].dir&&e.startsWith(d.IMPORT_PATHS.images)})),f={},p={},l=_(n),e.next=13,Promise.all(u.map(function(){var e=Object(o.a)(a.a.mark((function e(t){var r,n,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=c.indexOf(t)>=0)||!(s.indexOf(t)<0)){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return n=r?"text":"base64",o=null,e.prev=5,e.next=8,i.files[t].async(n);case 8:o=e.sent,r?"undefined"!==typeof(u=JSON.parse(o)).ext_cboard_hidden&&u.ext_cboard_hidden||"root"===u.id||l.includes(u.id)||(f[t]=u):t.startsWith("images//")?p[t.substring(7)]=o:p[t]=o,e.next=14;break;case 12:e.prev=12,e.t0=e.catch(5);case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}()));case 13:b=[],e.t0=a.a.keys(f);case 15:if((e.t1=e.t0()).done){e.next=23;break}return v=e.t1.value,e.next=19,m(f[v],f,p);case 19:y=e.sent,b.push(y),e.next=15;break;case 23:return e.abrupt("return",b);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t,r){return T.apply(this,arguments)}function T(){return(T=Object(o.a)(a.a.mark((function e(t,r,n){var o,i,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new FileReader,e.next=3,new Promise((function(e){o.onload=function(t){if(2===t.target.readyState)try{var r=JSON.parse(o.result);e(r)}catch(n){e(n)}},o.readAsText(t)}));case 3:if("object"===typeof(i=e.sent)){e.next=6;break}throw new Error(i);case 6:return e.next=8,m(i,{},{},n);case 8:if(!(u=e.sent)){e.next=11;break}return e.abrupt("return",[u]);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return I.apply(this,arguments)}function I(){return(I=Object(o.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=JSON.stringify(t).length)>4194304)){e.next=15;break}if(!(navigator&&navigator.webkitPersistentStorage&&navigator.webkitPersistentStorage.requestQuota)){e.next=14;break}return e.prev=4,e.next=7,new Promise((function(e,t){navigator.webkitPersistentStorage.requestQuota(2*r,(function(n){n>=r?e():t("Granted size is below the limit: ".concat(n))}),(function(e){return t("Request quota error: ".concat(e))}))}));case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),new Error(e.t0);case 12:e.next=15;break;case 14:throw new Error("Can't request quota");case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}},1893:function(e,t,r){"use strict";var n={};function a(){try{return new window.XMLHttpRequest}catch(e){}}n._getBinaryFromXHR=function(e){return e.response||e.responseText};var o="undefined"!==typeof window&&window.ActiveXObject?function(){return a()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:a;n.getBinaryContent=function(e,t){var r,a,i,u;t||(t={}),"function"===typeof t?(u=t,t={}):"function"===typeof t.callback&&(u=t.callback),u||"undefined"===typeof Promise?(a=function(e){u(null,e)},i=function(e){u(e,null)}):r=new Promise((function(e,t){a=e,i=t}));try{var c=o();c.open("GET",e,!0),"responseType"in c&&(c.responseType="arraybuffer"),c.overrideMimeType&&c.overrideMimeType("text/plain; charset=x-user-defined"),c.onreadystatechange=function(t){if(4===c.readyState)if(200===c.status||0===c.status)try{a(n._getBinaryFromXHR(c))}catch(r){i(new Error(r))}else i(new Error("Ajax error for "+e+" : "+this.status+" "+this.statusText))},t.progress&&(c.onprogress=function(r){t.progress({path:e,originalEvent:r,percent:r.loaded/r.total*100,loaded:r.loaded,total:r.total})}),c.send()}catch(s){i(new Error(s),null)}return r},e.exports=n}}]);
//# sourceMappingURL=2.a74b7ad1.chunk.js.map